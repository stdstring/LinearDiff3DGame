\documentclass{article}
\usepackage{young3}

\begin{document}
\atitle{Построение максимальных стабильных мостов в линейной 
дифференциальной игре третьего порядка}{Иванов~А.Г., Ушаков~А.В.%
\protect\footnote{Работа поддержана грантом РФФИ № 06-01-00414.}}%
[Иванов~А.Г., Ушаков~А.В. Построение максимальных стабильных мостов в линейной 
дифференциальной игре третьего порядка] 

\vspace{-1.75\baselineskip}
\centerline{\it e-mail:\ iagsoft@imm.uran.ru, beerzone@olympus.ru}

\vspace{\baselineskip}


{\bf 1.~} В работе рассматривается линейная дифференциальная игра 
с фиксированным моментом окончания:
\begin{equation*} \label{USHAKOVAVeq1}
\dot{x} = Ax + Bu + Cv, \ x \in R^m, \ u \in P \subset R, v \in Q \subset R .
\end{equation*}
Цель первого игрока, распоряжающегося управлением $u$,
--- приведение $n=3 \le m$ выделенных 
компонент фазового вектора $x$ в момент окончания $\theta$ на выпуклое ограниченное 
множество $M$. Интересы второго игрока, в ведении которого находится управление $v$, 
противоположны. Ограничения $P$ и $Q$ --- отрезки. Требуется построить
максимальный стабильный мост \cite{USHAKOVav00}.

Излагаемая ниже схема алгоритма соответствует работе \cite{USHAKOVav02}. 
Основанный на других идеях алгоритм решения линейных трехмерных задач
предложен в \cite{USHAKOVav04}.

{\bf 2.~} С помощью стандартного преобразования \cite{USHAKOVav00} сделаем переход к трехмерной
системе без фазовой 
переменной в правой части:
\begin{equation*} \label{USHAKOVAVeq2}
\begin{array}{c}
\dot{y} = D(t)u + E(t) v , \\
D(t) = X_n(\theta, t)B, \ E(t) = X_n(\theta, t) C .
\end{array} 
\end{equation*}
Здесь $X_n(\theta, t)$ --- соответствующие $n=3$ строк фундаментальной матрицы Коши.


%В случае, когда терминальное множество $M$ цилиндрично по всем координатам, за 
%исключением  $n=3$ координат, это преобразование позволяет понизить размерность задачи 
%до порядка $n$.

{\bf 3.~} Для построения максимального стабильного моста перейдем к аппроксимирующей игре, 
разбивая ось $t$ с шагом $\Delta$ влево от $\theta$
точками $t_i$, где $i=0, 1, \dots$, при этом $t_0=\theta$.
Результатом построений будут $t$-сечения $W_i=W(t_i)$ максимального 
стабильного моста $W$. Полагаем $W_0 = M$.

Выпуклый многогранник $W_i$
описываем при помощи опорной функции $\rho(W_i)$.
Для того, 
чтобы найти опорную функцию $\rho(W_{i+1})$ многогранника $W_{i+1}$,
\hfill
необходимо 
\hfill
построить
\hfill
выпуклую 
\hfill
оболочку \\ функции
\begin{equation*}
\eta_i(l) = \rho(l,F_i) - \rho(l, \Delta \cdot Q) ,
\end{equation*}
где $F_i=W_i-\Delta \!\cdot\! P_i$, $P_i=D(t_i) P$, $Q_i=E(t_i) Q$.

Для непрерывной, положительно однородной, кусочно-линейной функции $\rho$
в $R^3$ с 
выпуклыми конусами линейности используем следующее представление: вводим на 
единичной сфере $S$ сетку $G(\rho)$,
определяемую пересечением сферы с конусами линейности 
функции $\rho$. Если $I$ --- невырожденный выпуклый многогранник,
то каждому конусу 
линейности  функции $\rho(I)$ в сетке $G(\rho)$ соответствует многоугольный сектор на сфере. 
Выпуклая оболочка $\mathrm{conv}(\rho)$ функции $\rho$ есть опорная функция многогранника, получаемого 
пересечением полупространств $l^k y \le \rho (l^k)$  при переборе всех узлов $l^k$
сетки $G(\rho)$ (если 
узлы сетки $G(\rho)$ обозначить $l^k$).

При построении опорной функции $\rho(W_{i+1})$ требуем, чтобы все конусы 
линейности функции $\rho(W_i)$ были  трехгранными и, соответственно, секторы сетки 
$G(\rho(W_i))$ --- треугольными. Для этого нужно разбить секторы начальной сетки 
$G(\rho (W_0)) = G(\rho(M))$  на треугольные и в дальнейшем при образовании новых сеток 
вводить в случае необходимости дополнительное разбиение (за счет добавления 
необходимого количестве связей).

Сетка $G(\rho(F_i))$ 
\hfill
есть
\hfill
результат
\hfill
наложения
\hfill
сеток
\hfill
$G(\rho(W_i))$ 
и\\
$G(\rho(P_i))$. Поскольку $P_i$ --- отрезок, 
то $G(\rho(P_i))$ представляет собой окружность на сфере $S$ --- пересечение
сферы с проходящей 
через нуль плоскостью, ортогональной $P_i$. При наложении сеток появляются новые 
узлы (что очевидно), поэтому при построении сетки $G(\rho(F_i))$ необходимо устанавливать 
дополнительные связи для того, чтобы конусы линейности функции $\rho(F_i)$ были  
трехгранными. Построив сетку $G(\rho(F_i))$, получаем новую непрерывную, положительно 
однородную, кусочно-линейную функцию $\varphi_i$ такую, что
$G(\varphi_i) = G(\rho(F_i))$
и
$\varphi_i(l^k) = \eta_i(l^k)$
на каждом узле $l^k$.
В силу соотношений
$\mathrm{conv} (\varphi_i) = \mathrm{conv}(\eta_i) = \rho(W_{i+1})$
процесс 
построения $\rho(W_{i+1})$ удобнее начинать не с функции $\eta_i$,
а с функции $\varphi_i$, поскольку она 
устроена проще: ее сетка совпадает с $G(\rho(F_i))$.
Процесс построения сетки $G(\rho(F_i))$, как 
результата наложения сеток $G(\rho(W_i))$ и $G(\rho(P_i))$,
соответствует действиям первого игрока на $i+1$ шаге.

После нахождения функции $\varphi_i$ следует построить ее выпуклую оболочку. 
В 
основе алгоритма овыпукления лежит проверка локальной выпуклости на связи. Пусть 
$l_1l_2l_3$, $l_1l_2l_4$ - два сектора сетки $G(\varphi_i)$; функция 
$\varphi_i$ будет локально выпукла на связи $l_1l_2$, если 
склейка линейных на $\mathrm{cone}\{l_1, l_2, l_3\}$ и
$\mathrm{cone}\{l_1, l_2, l_4\}$ ее кусков выпукла на любом малом 
отрезке, пересекающем $\mathrm{cone}\{l_1, l_2\}$ 
 \cite{USHAKOVav02}.

Пусть $Z_i$ --- проходящая через нуль плоскость, ортогональная отрезку $Q_i$.
Локальная 
выпуклость функции $\varphi_i$ 
(и, соответственно, $\eta_i$) может нарушаться только на связях, 
пересекающих $Z_i$, либо на связях, у которых оба узла принадлежат одному 
и тому же 
полупространству относительно $Z_i$ и связаны с узлом, находящимся в другом 
полупространстве. Все связи сетки $G(\varphi_i)$ указанного типа заносятся в специальный набор 
$\Pi$. После заполнения набора $\Pi$ проводится анализ связей из этого набора на локальную 
выпуклость: если связь выпукла, то она выводится из набора $\Pi$  и проверяется следующая 
связь; если связь невыпукла, то происходит локальное изменение сетки $G(\varphi_i)$
и корректировка набора $\Pi$. Локальное изменение сетки $G(\varphi_i)$
и корректировка набора $\Pi$ 
зависят от коэффициентов $\lambda_1$, $\lambda_2$, которые получаются из решения уравнения
$
%\begin{equation} 
l_4 = \lambda_1 l_1 + \lambda_2 l_2 + \lambda_3 l_3 .
%\end{equation}
$
Поскольку секторы $l_1l_2l_3$ и $l_1l_2l_4$ --- смежные, то $\lambda_3 < 0$.
В зависимости от знаков 
коэффициентов $\lambda_1$, $\lambda_2$ возможны следующие действия:
удаление одного из узлов $l_1$ или $l_2$, 
замена связи $l_1l_2$ на связь $l_3l_4$, прекращение построений
\cite{USHAKOVav02}. Если в 
процессе овыпукления случай прекращения построений не реализуется, то процесс 
закончится, когда набор $\Pi$ исчерпается. При этом функция $\varphi_i$
будет локально выпуклой на 
всех связях своей сетки и будет совпадать с $\mathrm{conv}(\varphi_i)$.
Эта функция и будет опорной 
функцией $\rho (W_{i+1})$ многогранника $W_{i+1}$.

{\bf 4.~} При реализации описанного алгоритма построения сечений $W_i$
были использованы следующие алгоритмы: получение структуры 
выпуклого многогранника по заданным вершинам, построение графа
(сетки $G(\rho (W_0)))$ 
выпуклого многогранника по его структуре, триангуляция графа, построение сетки 
$G(\rho(F_i))$ как результата наложения сеток 
$G(\rho(W_i))$ и $G(\rho(P_i))$, построение набора $\Pi$ (набора 
связей, на которых может нарушаться локальная выпуклость функции $\varphi_i$),
удаление узла 
из графа и триангуляция полученного сектора, получение структуры выпуклого 
многогранника по его графу. Реализация большинства из этих алгоритмов 
достаточно сложна и требует применения динамических структур данных. Программа, 
реализующая алгоритм построения сечений $W_i$, была написана 
на языке $\mathrm{C\sharp}$, одним из преимуществ которого является упрощение работы с 
динамическими структурами данных.

Следует отметить, что получаемые многогранные сечения $W_i$
очень часто содержат (при больших временах $t_i$) 
большое количество расположенных рядом граней, нормали которых достаточно близки 
друг к другу. Наличие большого количества таких граней часто затрудняет анализ 
построенного сечения $W_i$. Для разрешения этой проблемы, при 
реализации алгоритма был введен параметр $\alpha$ (угол различимости), смысл которого в 
следующем: два узла $l^k$ и $l^{k'}$ (и, соответственно, две грани многогранника $W_i$)
сетки $G(\rho (W_i))$ считаются совпадающими, если угол между ними меньше величины параметра $\alpha$.
После слияния близких узлов (и, соответственно, граней многогранника $W_i$) сетки 
$G(\rho(W_i))$ в один, получается многогранник $W_i$ с более грубой структурой, что упрощает 
его анализ.




{\bf 5.~} В качестве примера рассмотрим игру с фиксированным моментом окончания $\theta$
и 
терминальной функцией платы $\gamma$:
\begin{equation*}
\left\{
\begin{array}{l}
\dot{x}_1 = x_2+v  \\
\dot{x}_2 = u 
\end{array} 
\right. 
\end{equation*}
\begin{equation*}
|u| \le 1 , \ |v| \le 1 , \ \gamma (x) = \max\{|x_1|, |x_2|\} .
\end{equation*}
Такая игра на промежутке $[0, 2]$ рассматривалась
в работе \cite{USHAKOVav06}. Нас интересуют надграфики функции цены для различных моментов времени.
Для этого \cite{USHAKOVav05}
к уравнениям динамики добавим соотношение
$\dot{c}=0$ и выберем целевое множество в виде:
$M=\left\{ (x_1, x_2, c): \right.$ 
$\left.\gamma(x) \le c \le \bar{c} \right\}$, 
где $\bar{c}$ --- некоторое фиксированное 
число. После перехода к эквивалентной игре без фазовой переменной можем
применить описанный выше алгоритм.
На рисунке приведены результаты расчета на ЭВМ 
для $t=\theta-1.8$, $\bar{c} = 2.5$, $\Delta =0.1$, $\alpha = 0.05$.

\begin{figure}[hbt]
\begin{center}
%\includegraphics[width=1cm, height=1cm]{ushakovav00.eps}
\includegraphics{ushakovav.eps}
%\caption{~Название рисунка~1}
Рис.~Сечение моста $W$ для момента $t=\theta-1.8$
\end{center}
\end{figure}



\begin{thebibliography}{9}

\bibitem{USHAKOVav00}
{\it Красовский~Н.Н., Субботин~А.И.} Позиционные дифференциальные игры. --- М.: Наука, 1974. 456~c.


\bibitem{USHAKOVav02}
{\it Зарх~М.А., Пацко~В.С.} Численное решение дифференциальной игры наведения третьего 
порядка.
// Изв. АН СССР. Техническая кибернетика. 1987. №~6. C.~162--169.

\bibitem{USHAKOVav04}
{\it Тарасьев~А.М., Успенский~А.А., Ушаков~В.Н.} Приближенное построение множества 
позиционного поглощения в линейной задаче сближения с выпуклой целью в 
пространстве $R^3$.
 / в сб. "Управление в динамических системах",
~С.~93--100. - Свердловск, 1990.


\bibitem{USHAKOVav06}
{\it Тарасьев~А.М.} Об одной нерегулярной дифференциальной игре.
// Прикладная матем. и механ. 1985. Т.49, вып.~4. C.~???--???.

\bibitem{USHAKOVav05}
{\it Субботин~А.И., Тарасьев~А.М.} Сопряженные производные
функции цены дифференциальной игры.
// Докл. АН СССР. 1987. Т.283, №~3. C.~???--???.



\end{thebibliography}

\end{document}

4. Тарасьев А.М., Успенский А.А., Ушаков В.Н. Приближенное построение множества 
позиционного поглощения в линейной задаче сближения с выпуклой целью в 
пространстве R3.

\bibitem{IVANOV2}
{\it Автор2~И.О.} Название статьи // Название журнала. 2000.
Т.~1, №~1. C.~1--10.

\bibitem{IVANOV3}
{\it Автор3~И.О.} Название статьи / в сб. "Название сборника", 
Труды ... конференции.~С.~202--206. - Издательство: Город, 2001.


\bibitem{USHAKOVav01}
{\it Зарх~М.А., Пацко~В.С.} 
Построение максимальных стабильных мостов в линейной дифференциальной игре.
 / в сб. "Синтез оптимального управления в игровых системах",
~С.~46--61. - Свердловск, 1986.
